var perfil={cache:{},load_tab:function(a,t){$("#tabs_menu > li").removeClass("selected"),$(t).parent().addClass("selected"),$("#perfil_content > div").fadeOut(),$("#perfil_load").fadeIn(),perfil.cargar(a)},cargar:function(a){var t=$("#perfil_"+a).attr("status");return"activo"==t?($("#perfil_load").hide(),$("#perfil_"+a).fadeIn(),!0):($("#loading").slideDown(250),void $.ajax({type:"POST",url:global_data.url+"/perfil-"+a+".php",data:"pid="+$("#info").attr("pid"),success:function(t){switch(t.charAt(0)){case"0":mydialog.alert("Error",t.substring(3));break;case"1":"undefined"==typeof perfil.cache[a]&&($("#perfil_content").append(t.substring(3)),$("#perfil_"+a).fadeIn(),perfil.cache[a]=!0)}$("#perfil_load").hide(),$("#loading").slideUp(350)}}))},follows:function(a,t){$.ajax({type:"POST",url:global_data.url+"/perfil-"+a+".php?hide=true&page="+t,data:"pid="+$("#info").attr("pid"),success:function(t){$("#perfil_"+a).html(t.substring(3))}})}},actividad={total:25,show:25,cargar:function(a,t,e){$("#last-activity-view-more").remove(),"filtrar"==t&&(actividad.total=0),$.ajax({type:"POST",url:global_data.url+"/perfil-actividad.php",data:"pid="+$("#info").attr("pid")+"&ac_type="+e+"&do="+t+"&start="+actividad.total,success:function(a){switch(a.charAt(0)){case"0":mydialog.alert("Error",a.substring(3));break;case"1":"more"==t?$("#last-activity-container").append(a.substring(3)):$("#last-activity-container").html(a.substring(3));var e=$("#total_acts").attr("val");actividad.total=actividad.total+parseInt(e),$("#total_acts").remove()}}})},borrar:function(a,t){$.ajax({type:"POST",url:global_data.url+"/perfil-actividad.php",data:"pid="+$("#info").attr("pid")+"&acid="+a+"&do=borrar",success:function(a){switch(a.charAt(0)){case"0":mydialog.alert("Error",a.substring(3));break;case"1":$(t).parent().parent().parent().remove()}}})}},muro={maxWidth:463,stream:{total:0,show:10,type:"status",status:0,adjunto:"",load:function(a,t){muro.stream.type=a;var e="foto"==muro.stream.type?"a":"e";return e="Haz un comentario sobre est"+e+" "+muro.stream.type+"...","status"!=a?($(".btnStatus").hide(),$(".attaDesc").show(),$("#attaDesc").attr("title",e).val(e)):($(".btnStatus").show(),$(".attaDesc").hide(),$(".frameForm").css("border-bottom","1px solid #E9E9E9")),$("span.uiComposer .nub, span.uiComposer span").hide(),$("span.uiComposer a").show(),$(t).hide().parent().find("span, i").show(),$("#attaContent > div").hide(),$("#"+a+"Frame").show(),!1},adjuntar:function(){if(1==muro.stream.status)return!1;muro.stream.status=1,muro.stream.loader(!0);var a=$("input[name=i"+muro.stream.type+"]");a.attr("disabled","true");var t=muro.stream.validar(a);1==t?muro.stream.ajaxCheck(a.val(),a):(mydialog.alert("Error al publicar",t),muro.stream.loader(!1),a.attr("disabled",""),muro.stream.status=0)},ajaxCheck:function(a,t){$("#loading").fadeIn(250),$.ajax({type:"POST",url:global_data.url+"/muro-stream.php?do=check&type="+muro.stream.type,data:"url="+encodeURIComponent(a),success:function(a){switch(a.charAt(0)){case"0":mydialog.alert("Error al publicar",a.substring(3)),t.attr("disabled","");break;case"1":muro.stream.adjunto=t.val(),$("#"+muro.stream.type+"Frame").html(a.substring(3))}$("#loading").fadeOut(350)},complete:function(){muro.stream.loader(!1),muro.stream.status=0,$("#loading").fadeOut(350)}})},validar:function(a){var t=a.val(),e=/^(ht|f)tps?:\/\/\w+([\.\-\w]+)?\.([a-z]{2,3}|info|mobi|aero|asia|name)(:\d{2,5})?(\/)?((\/).+)?$/i;if(""==t||t==a.attr("title")||0==e.test(t))return"Debes ingresar una direcci&oacute;n URL v&aacute;lida.";switch(muro.stream.type){case"foto":a.val(t.replace(" ",""));var r=a.val().substr(-3);if("gif"!=r&&"png"!=r&&"jpg"!=r)return"S&oacute;lo se permiten im&aacute;genes .gif, .png y .jpg";break;case"video":var s=t.split("watch?v=");if(!s[1])return"Al parecer la url del video no es v&aacute;lida. Recuerda que solo puedes compartir videos de YouTube."}return!0},compartir:function(){if(1==muro.stream.status)return!1;muro.stream.status=1,muro.stream.loader(!0);var a="Las publicaciones de estado y/o comentarios deben ser inferiores a 420 caracteres. Ya has ingresado ";if("status"!=muro.stream.type)if(""!=muro.stream.adjunto){var t=$("#attaDesc").val();t.length>420?(mydialog.alert("Error al publicar",a+t.length+" caracteres."),muro.stream.loader(!1),muro.stream.status=0):(t=t==$("#attaDesc").attr("title")?"":t,muro.stream.ajaxPost(t))}else mydialog.alert("Error al publicar","Ingresa la <b>URL</b> en el campo de texto y a continuaci&oacute;n da clic en <b>Adjuntar</b>."),muro.stream.loader(!1),muro.stream.status=0;else if("status"==muro.stream.type){var e=$("#wall"),t=e.val(),r=!1;if(""==t||t==e.attr("title"))return e.blur(),r=!0,muro.stream.loader(!1),muro.stream.status=0,!1;t.length>420&&(r=a+t.length+" caracteres."),0==r?muro.stream.ajaxPost(t):(mydialog.alert("Error al publicar",r),muro.stream.loader(!1),muro.stream.status=0)}},ajaxPost:function(a){$("#loading").slideDown(250),$.ajax({type:"POST",url:global_data.url+"/muro-stream.php?do=post&type="+muro.stream.type,data:"adj="+muro.stream.adjunto+"&data="+encodeURIComponent(a)+"&pid="+$("#info").attr("pid"),success:function(a){switch(a.charAt(0)){case"0":mydialog.alert("Error al publicar",a.substring(3));break;case"1":$("#wall-content .emptyData")&&$("#wall-content .emptyData").hide(),$("#wall-content").prepend($(a.substring(3)).fadeIn("slow")),$("#wall").val("").focus(),muro.stream.load("status",$("#stMain"))}$("#loading").slideUp(350)},complete:function(){muro.stream.loader(!1),muro.stream.status=0,$("#loading").fadeOut(350)}})},loadMore:function(a){return 1==muro.stream.status?!1:(muro.stream.status=1,$(".more-pubs a").hide(),$(".more-pubs span").css("display","block"),$("#loading").fadeIn(250),void $.ajax({type:"POST",url:global_data.url+"/muro-stream.php?do=more&type="+a,data:"pid="+$("#info").attr("pid")+"&start="+muro.stream.total,success:function(t){switch(t.charAt(0)){case"0":mydialog.alert("Error al cargar",t.substring(3));break;case"1":$("#"+a+"-content").append(t.substring(3));var e=$("#total_pubs").attr("val");e=parseInt(e);var r="news"==a&&0>e?"Solo puedes ver las &uacute;ltimas 100 publicaciones.":"No hay m&aacute;s mensajes para mostrar.";0==e||e<muro.stream.show?$(".more-pubs").html(r).css("padding","10px"):muro.stream.total=muro.stream.total+parseInt(e),$("#total_pubs").remove()}$("#loading").fadeOut(250)},complete:function(){$(".more-pubs a").show(),$(".more-pubs span").hide(),muro.stream.status=0,$("#loading").fadeOut(450)}}))},loader:function(a){1==a?$(".streamLoader").show():0==a&&$(".streamLoader").hide()}},like_this:function(a,t,e){muro.stream.status=1,$("#loading").slideDown(250),$.ajax({type:"POST",url:global_data.url+"/muro-likes.php",dataType:"json",data:"id="+a+"&type="+t,success:function(r){"ok"==r.status?($(e).text(r.link),"pub"==t?($("#lk_"+a).html(r.text),""!=r.text?($("#lk_"+a).parent().parent().show(),$("#cb_"+a).show()):$("#lk_"+a).parent().parent().hide()):($("#lk_cm_"+a).text(r.text),""==r.text?$("#lk_cm_"+a).parent().hide():$("#lk_cm_"+a).parent().show())):mydialog.alert("Error:",r.text.substring(3)),$("#loading").slideUp(350)},complete:function(){muro.stream.status=0}})},show_likes:function(a,t){muro.stream.status=1,$("#loading").fadeIn(250),$.ajax({type:"POST",url:global_data.url+"/muro-likes.php?do=show",dataType:"json",data:"id="+a+"&type="+t,success:function(a){switch(a.status){case 0:mydialog.alert("Error",a.data);break;case 1:for(var t='<ul id="show_likes">',e=0;e<a.data.length;e++)t+="<li>",t+='<a href="'+global_data.url+"/perfil/"+a.data[e].user_name+'"><img src="'+global_data.url+"/files/avatar/"+a.data[e].user_id+'_50.jpg" /></a>',t+='<div class="name"><a href="'+global_data.url+"/perfil/"+a.data[e].user_name+'">'+a.data[e].user_name+"</a></div>",t+="</li>";t+="</ul>",mydialog.show(!0),mydialog.title("Personas a las que les gusta"),mydialog.body(t),mydialog.buttons(!0,!0,"Cerrar","close",!0,!0),mydialog.center()}$("#loading").fadeOut(350)},complete:function(){muro.stream.status=0}})},show_comment_box:function(a){$("#cb_"+a).slideDown()},comentar:function(a){var t=$("#cf_"+a).val();return muro.stream.status=1,""==t||t==$("#cf_"+a).attr("title")?($("#cf_"+a).focus(),muro.stream.loader(!1),muro.stream.status=0,!1):($("#loading").fadeIn(250),void $.ajax({type:"POST",url:global_data.url+"/muro-stream.php?do=repost",data:"data="+encodeURIComponent(t)+"&pid="+a,success:function(t){switch(t.charAt(0)){case"0":mydialog.alert("Error:",t.substring(3));break;case"1":$("#cl_"+a).append($(t.substring(3)).fadeIn("slow")),$("#cf_"+a).val("")}$("#loading").fadeOut(250)},complete:function(){muro.stream.status=0,$("#loading").fadeOut(350)}}))},more_comments:function(a,t){muro.stream.status=1,$(t).parent().find("img").show(),$("#loading").fadeIn(250),$.ajax({type:"POST",url:global_data.url+"/muro-stream.php?do=more_comments",data:"pid="+a,success:function(t){switch(t.charAt(0)){case"0":mydialog.alert("Error:",t.substring(3));break;case"1":$("#cl_"+a).html(t.substring(3))}$("#loading").fadeOut(350)},complete:function(){muro.stream.status=0,$("#loading").fadeOut(550)}})},load_atta:function(a,t,e){switch(a){case"foto":var r='<center><img src="'+t+'" style="max-width:'+this.maxWidth+'px; max-height: 380px" /><center>';break;case"video":var r='<embed width="'+this.maxWidth+'" height="285" flashvars="width='+this.maxWidth+'&amp;height=285" wmode="opaque" salign="tl" allowscriptaccess="never" allowfullscreen="false" scale="scale" quality="high" bgcolor="#FFFFFF" src="http://www.youtube.com/v/'+t+'&amp;autoplay=1" type="application/x-shockwave-flash">'}$(e).parent().html(r)},del_pub:function(a,t){var e=1==t?"publicaci&oacute;n":"comentario",r=1==t?"esta ":"este ";mydialog.mask_close=!1,mydialog.show(!0),mydialog.title("Eliminar "+e),mydialog.body("Â¿Seguro que quieres eliminar "+r+e),mydialog.buttons(!0,!0,"Eliminar "+e,"muro.eliminar("+a+", "+t+")",!0,!0,!0,"Cancelar","close",!0,!1),mydialog.center()},eliminar:function(a,t){muro.stream.status=1;var e=1==t?"pub":"cmt";$("#loading").slideDown(250),$.ajax({type:"POST",url:global_data.url+"/muro-stream.php?do=delete",data:"id="+a+"&type="+e,success:function(t){switch(t.charAt(0)){case"0":mydialog.alert("Error:",t.substring(3));break;case"1":mydialog.close(),$("#"+e+"_"+a).hide().remove()}$("#loading").slideUp(450)},complete:function(){muro.stream.status=0,$("#loading").slideUp(350)}})}};$(function(){setTimeout("$('#wall, #attaDesc').blur().css('height', '70px')",0),setTimeout("$('#attaContent input').blur().css('height', '30px')",0),$("#wall").focus(function(){$(".btnStatus").show(),$(".frameForm").css("border-bottom","1px solid #E9E9E9")}),$("textarea[name=add_wall_comment]").live("keypress",function(a){if(13==a.which){var t=$(this).attr("pid");return muro.comentar(t),!1}}),$(".adj").click(function(){$(this).attr("aid")}),$(".comentar").css("max-height","200px").autogrow().css("height","14px"),$("input[name=hack]").live("focus",function(){$(this).hide(),$(this).parent().find("div.formulario").show();var a=$(this).attr("pid");$("#cf_"+a).focus()})});